1. Create hadoop architecture diagram.

    hadoop/questions/Diagrams/Hadoop Architecture.drawio

2. Create hive architecture diagram.

    hadoop/questions/Diagrams/Hive Architecture.drawio

3. What is difference between dynamic partition vs static partition?

    static partitions are set up manually after creating the table using the 'alter table tablename add partition'
    command and then manually adding the data sources into that folder in your filesystem. dynamic partitions are set
    up by giving hive the column names you would like to partition by and then inserting data using an insert command.
    Hive will then create the partitions automatically. Using dynamic partitions makes it possible to have hive store the
    data as parquet files and make all the partitions itself.

4. How to explain plan of hive query?


there ev_vehicle datasets in hive/data folder.

1. Create a external table to store the data.  [Table name: ev_vehicle_info_src]
2. Create another table with partition by make.  [ Parquet table with snappy compression][Table name:ev_vehicle_info]


3. Write a sql to show top 3 by number of vehicle registered by make. [ sql should be in file. the number to pas is dynamic. it can be 3 is can be 5]

    select make, num_registered,
    rank() over(order by num_registered desc) as num_registered_rank
    from (select make, count(*) as num_registered
    from ev_vehicle_info
    group by make)


4. Find out the vehicle which are Not eligible due to low battery range='Not eligible due to low battery range'

    select make, model, model_year
    from ev_vehicle_info
    where cafv_eligibility='Not eligible due to low battery range'
    group by make, model, model_year

5. write a sql to show how many distinct model for each maker.

    select make as Manufacturer, count(distinct model) as num_models
    from ev_vehicle_info
    group by make

6.Write sql to count number of vehicle where Model Year < 2018 and Not eligible due to low battery range='Not eligible due to low battery range'

    select count(*) as old_ineligible_vehicles
    from ev_vehicle_info
    where model_year < 2018 and cafv_eligibility = 'Not eligible due to low battery range'